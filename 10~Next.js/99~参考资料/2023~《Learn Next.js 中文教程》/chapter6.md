# å»ºç«‹ä½ çš„æ•°æ®åº“

åœ¨ç»§ç»­å·¥ä½œäºä½ çš„ dashboard ä¹‹å‰ï¼Œä½ éœ€è¦ä¸€äº›æ•°æ®ã€‚åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å°†ä½¿ç”¨ @vercel/postgres æ¥è®¾ç½®ä¸€ä¸ª PostgreSQL æ•°æ®åº“ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰ PostgreSQL å¹¶ä¸”æ›´æ„¿æ„ä½¿ç”¨è‡ªå·±çš„æä¾›è€…ï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€ç« å¹¶è‡ªè¡Œè®¾ç½®ã€‚å¦åˆ™ï¼Œè®©æˆ‘ä»¬ç»§ç»­å§ï¼

ä»¥ä¸‹æ˜¯æœ¬ç« ä¸­å°†æ¶µç›–çš„ä¸»é¢˜ï¼š

- å°†ä½ çš„é¡¹ç›®æ¨é€åˆ° GitHubã€‚
- è®¾ç½® Vercel è´¦æˆ·å¹¶é“¾æ¥ä½ çš„ GitHub å­˜å‚¨åº“ä»¥è¿›è¡Œå³æ—¶é¢„è§ˆå’Œéƒ¨ç½²ã€‚
- åˆ›å»ºå¹¶å°†ä½ çš„é¡¹ç›®é“¾æ¥åˆ°ä¸€ä¸ª PostgreSQL æ•°æ®åº“ã€‚
- ä½¿ç”¨åˆå§‹æ•°æ®å¡«å……æ•°æ®åº“ã€‚

## åˆ›å»º GitHub å­˜å‚¨åº“

é¦–å…ˆï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰è¿™æ ·åšï¼Œè®©æˆ‘ä»¬å°†ä½ çš„å­˜å‚¨åº“æ¨é€åˆ° GitHubã€‚è¿™å°†ä½¿è®¾ç½®æ•°æ®åº“å’Œéƒ¨ç½²å˜å¾—æ›´å®¹æ˜“ã€‚

å¦‚æœä½ éœ€è¦å¸®åŠ©è®¾ç½®ä½ çš„å­˜å‚¨åº“ï¼Œè¯·æŸ¥çœ‹ GitHub ä¸Šçš„[è¿™ç¯‡æŒ‡å—](https://help.github.com/en/github/getting-started-with-github/create-a-repo)ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼š
>
> - ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»– Git æä¾›è€…ï¼Œå¦‚ GitLab æˆ– Bitbucketã€‚
> - å¦‚æœä½ å¯¹ GitHub ä¸ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ [GitHub Desktop App](https://desktop.github.com/) ä»¥ç®€åŒ–å¼€å‘å·¥ä½œæµç¨‹ã€‚

## åˆ›å»º Vercel è´¦æˆ·

è®¿é—® [vercel.com/signup](https://vercel.com/signup) åˆ›å»ºä¸€ä¸ªè´¦æˆ·ã€‚é€‰æ‹©å…è´¹çš„ "`hobby`" è®¡åˆ’ã€‚é€‰æ‹© **"Continue with GitHub"** æ¥è¿æ¥ä½ çš„ GitHub å’Œ Vercel è´¦æˆ·ã€‚

## è¿æ¥å¹¶éƒ¨ç½²ä½ çš„é¡¹ç›®

æ¥ä¸‹æ¥ï¼Œä½ å°†è¢«å¸¦åˆ°è¿™ä¸ªå±å¹•ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥é€‰æ‹©å¯¼å…¥ä½ åˆšåˆšåˆ›å»ºçš„ GitHub å­˜å‚¨åº“ï¼š

![](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-import-git-repo.avif)

ç»™ä½ çš„é¡¹ç›®å–ä¸€ä¸ªåå­—ï¼Œç„¶åç‚¹å‡» Deployï¼ˆéƒ¨ç½²ï¼‰ã€‚

![](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-configure-project.avif)

å¤ªæ£’äº†ï¼ğŸ‰ ä½ çš„é¡¹ç›®ç°åœ¨å·²ç»éƒ¨ç½²å®Œæˆã€‚

![](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-deployed-project.avif)

é€šè¿‡è¿æ¥ä½ çš„ GitHub å­˜å‚¨åº“ï¼Œæ¯å½“ä½ æ¨é€æ›´æ”¹åˆ°ä¸»åˆ†æ”¯æ—¶ï¼ŒVercel å°†è‡ªåŠ¨é‡æ–°éƒ¨ç½²ä½ çš„åº”ç”¨ç¨‹åºï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚åœ¨å‘èµ·æ‹‰å–è¯·æ±‚æ—¶ï¼Œä½ è¿˜å°†è·å¾—[å³æ—¶é¢„è§ˆ](https://vercel.com/docs/deployments/preview-deployments#preview-urls)ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åŠæ—©å‘ç°éƒ¨ç½²é”™è¯¯ï¼Œå¹¶ä¸å›¢é˜Ÿæˆå‘˜åˆ†äº«é¡¹ç›®çš„é¢„è§ˆä»¥è·å¾—åé¦ˆã€‚

## åˆ›å»ºä¸€ä¸ª Postgres æ•°æ®åº“

æ¥ä¸‹æ¥ï¼Œä¸ºäº†è®¾ç½®æ•°æ®åº“ï¼Œç‚¹å‡» **Continue to Dashboard** å¹¶ä»é¡¹ç›®ä»ªè¡¨æ¿ä¸­é€‰æ‹© **Storage** é€‰é¡¹å¡ã€‚é€‰æ‹© **Connect Store** â†’ **Create New** â†’ **Postgres** â†’ **Continue**.

![Connect Store å±å¹•æ˜¾ç¤ºäº† Postgres é€‰é¡¹ä»¥åŠ KVã€Blob å’Œ Edge Config](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-create-database.avif)

æ¥å—æ¡æ¬¾ï¼Œä¸ºä½ çš„æ•°æ®åº“åˆ†é…ä¸€ä¸ªåç§°ï¼Œå¹¶ç¡®ä¿ä½ çš„æ•°æ®åº“åŒºåŸŸè®¾ç½®ä¸º **Washington D.C (iad1)** - è¿™ä¹Ÿæ˜¯æ‰€æœ‰æ–° Vercel é¡¹ç›®çš„[é»˜è®¤åŒºåŸŸ](https://vercel.com/docs/functions/serverless-functions/regions#select-a-default-serverless-region)ã€‚é€šè¿‡å°†æ•°æ®åº“æ”¾ç½®åœ¨ä¸åº”ç”¨ç¨‹åºä»£ç ç›¸åŒçš„åŒºåŸŸæˆ–é è¿‘åº”ç”¨ç¨‹åºä»£ç çš„åŒºåŸŸï¼Œå¯ä»¥å‡å°‘æ•°æ®è¯·æ±‚çš„å»¶è¿Ÿã€‚

![æ•°æ®åº“åˆ›å»ºæ¨¡æ€æ¡†æ˜¾ç¤ºäº†æ•°æ®åº“åç§°å’ŒåŒºåŸŸ](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-database-region.avif)

**éœ€è¦æ³¨æ„çš„æ˜¯**ï¼šä¸€æ—¦åˆå§‹åŒ–åï¼Œä½ æ— æ³•æ›´æ”¹æ•°æ®åº“åŒºåŸŸã€‚å¦‚æœä½ æƒ³ä½¿ç”¨ä¸åŒçš„[åŒºåŸŸ](https://vercel.com/docs/storage/vercel-postgres/limits#supported-regions)ï¼Œä½ åº”è¯¥åœ¨åˆ›å»ºæ•°æ®åº“ä¹‹å‰è®¾ç½®å®ƒã€‚

è¿æ¥åï¼Œè½¬åˆ° `.env.local` é€‰é¡¹å¡ï¼Œç‚¹å‡» â€œShow secretâ€ å¹¶å¤åˆ¶ç‰‡æ®µã€‚

![.env.local é€‰é¡¹å¡æ˜¾ç¤ºäº†éšè—çš„æ•°æ®åº“ç§˜å¯†](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-database-dashboard.avif)

è½¬åˆ°ä½ çš„ä»£ç ç¼–è¾‘å™¨ï¼Œå°† `.env.example` æ–‡ä»¶é‡å‘½åä¸º `.env`ã€‚ç²˜è´´ä» Vercel å¤åˆ¶çš„å†…å®¹ã€‚

**é‡è¦æç¤º**ï¼šè¿›å…¥ä½ çš„ `.gitignore` æ–‡ä»¶ï¼Œç¡®ä¿ `.env` æ˜¯è¢«å¿½ç•¥çš„æ–‡ä»¶ä¹‹ä¸€ï¼Œä»¥é˜²æ­¢åœ¨æ¨é€åˆ° GitHub æ—¶æš´éœ²ä½ çš„æ•°æ®åº“ç§˜å¯†ã€‚

æœ€åï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œ `npm i @vercel/postgres` å®‰è£… [Vercel Postgres SDK](https://vercel.com/docs/storage/vercel-postgres/sdk)ã€‚

## å¡«å……ä½ çš„æ•°æ®åº“

æ—¢ç„¶ä½ çš„æ•°æ®åº“å·²ç»åˆ›å»ºå¥½äº†ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸€äº›åˆå§‹æ•°æ®å¡«å……å®ƒã€‚è¿™å°†ä½¿ä½ åœ¨æ„å»º Dashboard æ—¶æœ‰ä¸€äº›å¯ç”¨çš„æ•°æ®ã€‚

åœ¨é¡¹ç›®çš„ `/scripts` æ–‡ä»¶å¤¹ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º `seed.js` çš„æ–‡ä»¶ã€‚è¿™ä¸ªè„šæœ¬åŒ…å«äº†åˆ›å»ºå’Œå¡«å……å‘ç¥¨ã€å®¢æˆ·ã€ç”¨æˆ·ã€æ”¶å…¥è¡¨çš„æŒ‡ä»¤ã€‚

å¦‚æœä½ ä¸ç†è§£ä»£ç åœ¨åšä»€ä¹ˆçš„è¯ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œä½†ä¸ºäº†ç»™ä½ ä¸€ä¸ªæ¦‚è¿°ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ SQL æ¥åˆ›å»ºè¡¨ï¼Œç„¶åä½¿ç”¨ `placeholder-data.js` æ–‡ä»¶ä¸­çš„æ•°æ®åœ¨è¡¨åˆ›å»ºåå¡«å……å®ƒä»¬ã€‚

æ¥ä¸‹æ¥ï¼Œåœ¨ä½ çš„ `package.json` æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œåˆ°ä½ çš„ scriptsï¼š

```jsx showLineNumbers filename="/package.json" {5} copy
"scripts": {
  "build": "next build",
  "dev": "next dev",
  "start": "next start",
  "seed": "node -r dotenv/config ./scripts/seed.js"
},
```

è¿™æ˜¯æ‰§è¡Œ `seed.js` çš„å‘½ä»¤ã€‚

ç°åœ¨ï¼Œè¿è¡Œ `npm run seed`ã€‚ä½ åº”è¯¥åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°ä¸€äº› `console.log` æ¶ˆæ¯ï¼Œè®©ä½ çŸ¥é“è„šæœ¬æ­£åœ¨è¿è¡Œã€‚

<QuizComponent
name="åœ¨æ•°æ®åº“çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œâ€œseedingâ€ æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ"
answers={[
"åˆ é™¤æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®",
"å¯¼å…¥æ•°æ®åº“çš„æ¶æ„",
"ä½¿ç”¨åˆå§‹æ•°æ®å¡«å……æ•°æ®åº“",
"åœ¨æ•°æ®åº“ä¸­åˆ›å»ºè¡¨ä¹‹é—´çš„å…³ç³»",
]}
correctAnswer="ä½¿ç”¨åˆå§‹æ•°æ®å¡«å……æ•°æ®åº“"
/>

**æ•…éšœæ’é™¤**ï¼š

- ç¡®ä¿åœ¨å°†æ•°æ®åº“ç§˜å¯†å¤åˆ¶åˆ° `.env` æ–‡ä»¶ä¹‹å‰å…ˆå°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚
- è„šæœ¬ä½¿ç”¨ bcrypt å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œå“ˆå¸Œï¼Œå¦‚æœ bcrypt ä¸ä½ çš„ç¯å¢ƒä¸å…¼å®¹ï¼Œä½ å¯ä»¥æ›´æ–°è„šæœ¬ä»¥ä½¿ç”¨ [bcryptjs](https://www.npmjs.com/package/bcryptjs)ã€‚
- å¦‚æœåœ¨å¡«å……æ•°æ®åº“æ—¶é‡åˆ°ä»»ä½•é—®é¢˜å¹¶å¸Œæœ›é‡æ–°è¿è¡Œè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡åœ¨æ•°æ®åº“æŸ¥è¯¢ç•Œé¢ä¸­è¿è¡Œ `DROP TABLE tablename` æ¥åˆ é™¤ä»»ä½•ç°æœ‰è¡¨ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„[æ‰§è¡ŒæŸ¥è¯¢éƒ¨åˆ†](https://nextjs.org/learn/dashboard-app/setting-up-your-database#executing-queries)ã€‚ä½†è¦å°å¿ƒï¼Œè¿™ä¸ªå‘½ä»¤å°†åˆ é™¤è¡¨å’Œå®ƒä»¬çš„æ‰€æœ‰æ•°æ®ã€‚ç”±äºä½ åœ¨ç¤ºä¾‹åº”ç”¨ä¸­ä½¿ç”¨å ä½æ•°æ®ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥è¿™æ ·åšï¼Œä½†åœ¨ç”Ÿäº§åº”ç”¨ä¸­ä¸åº”è¯¥è¿è¡Œæ­¤å‘½ä»¤ã€‚
- å¦‚æœåœ¨å¡«å……ä½ çš„ Vercel Postgres æ•°æ®åº“æ—¶ç»§ç»­é‡åˆ°é—®é¢˜ï¼Œè¯·åœ¨ [GitHub ä¸Šå‘èµ·è®¨è®º](https://github.com/vercel/next-learn/issues)ã€‚

## æµè§ˆä½ çš„æ•°æ®åº“

è®©æˆ‘ä»¬çœ‹çœ‹ä½ çš„æ•°æ®åº“æ˜¯ä»€ä¹ˆæ ·å­ã€‚å›åˆ° Vercelï¼Œå¹¶ç‚¹å‡»ä¾§è¾¹å¯¼èˆªä¸Šçš„ **Data**ã€‚

åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œä½ ä¼šæ‰¾åˆ°å››ä¸ªæ–°è¡¨ï¼šusersã€customersã€invoices å’Œ revenueã€‚

![æ•°æ®åº“å±å¹•æ˜¾ç¤ºäº†ä¸‹æ‹‰åˆ—è¡¨ï¼Œå…¶ä¸­æœ‰å››ä¸ªè¡¨ï¼šusersã€customersã€invoices å’Œ revenue](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter6-database-tables.avif)

é€šè¿‡é€‰æ‹©æ¯ä¸ªè¡¨ï¼Œä½ å¯ä»¥æŸ¥çœ‹å…¶è®°å½•ï¼Œå¹¶ç¡®ä¿æ¡ç›®ä¸ `placeholder-data.js` æ–‡ä»¶ä¸­çš„æ•°æ®ä¸€è‡´ã€‚

## æ‰§è¡ŒæŸ¥è¯¢

ä½ å¯ä»¥åˆ‡æ¢åˆ° `â€œqueryâ€` é€‰é¡¹å¡ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚è¿™ä¸ªéƒ¨åˆ†æ”¯æŒæ ‡å‡†çš„ SQL å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ `DROP TABLE customers` å°†åˆ é™¤ `"customers"` è¡¨ä»¥åŠæ‰€æœ‰å…¶æ•°æ® - æ‰€ä»¥è¦å°å¿ƒï¼

è®©æˆ‘ä»¬è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢ã€‚å°†ä»¥ä¸‹ SQL ä»£ç ç²˜è´´å¹¶è¿è¡Œåˆ° Vercel ç•Œé¢ä¸­ï¼š

```jsx showLineNumbers copy
SELECT invoices.amount, customers.name
FROM invoices
JOIN customers ON invoices.customer_id = customers.id
WHERE invoices.amount = 666;
```

<QuizComponent
name="è¿™ä¸ªå‘ç¥¨å±äºå“ªä¸ªå®¢æˆ·ï¼Ÿ"
answers={["Lee Robinson", "Evil Rabbit", "Delba de Oliveira", "Steph Dietz"]}
correctAnswer="Evil Rabbit"
/>

## Vercel Postgres æ­é…æœ¬åœ°æ•°æ®åº“

åœ¨æœ¬åœ°å¼€å‘æ—¶ä½ å¯èƒ½æƒ³ä½¿ç”¨æœ¬åœ°æ­å»ºçš„ Postgres æ•°æ®åº“ï¼Œä½† `Vercel Postgres` ç›®å‰æ”¯æŒçš„å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œè¯¦æƒ…è¯·å‚è§ [æ‰©å±•ç¯‡ 1ï¼šVercel Postgres æ­é…æœ¬åœ°æ•°æ®åº“](https://ngte-superbed.oss-cn-beijing.aliyuncs.com/book/nextjs-learn-cn/public/chapter17)
